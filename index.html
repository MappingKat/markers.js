<!DOCTYPE html>
<html>
  <head>
    <title>mmg: simple markers for Modest Maps</title>
    <link href='css/site.css' rel='stylesheet' type='text/css' />
    <script type='text/javascript' src='lib/modestmaps.min.js'></script>
    <script type='text/javascript' src='lib/wax.mm.min.js'></script>
    <script type='text/javascript' src='src/mmg.js'></script>
  </head>
  <body>
    <div class='column'>
      <h2><a href='http://mapbox.com/'>MapBox</a> mmg</h2>
      <div id='map'></div>

      <a class='link-panel' href='https://github.com/mapbox/mmg'>Clone or Download on GitHub &rarr;</a>

      <a class='link-panel' href='https://github.com/mapbox/mmg/wiki'>Developer Documentation &rarr;</a>

      <a class='link-panel' href='http://mapbox.com/mmg/test/'>Test Suite &rarr;</a>

      <p><strong>mmg</strong> adds points in <a href='http://www.geojson.org/'>GeoJSON</a>
      on maps powered <a href='http://modestmaps.org/'>Modest Maps</a>. There are no other dependencies,
      and it's designed to work cross-browser.</p>

      <p>It's a chaining API, so the constructor, <code>mmg()</code>, takes no arguments,
      but returns an object with <code>.factory(function(x) { return elem; })</code> and
      <code>.features([geojson_objects])</code> methods. It'll accept any GeoJSON object - bring your own
      AJAX and JSON.parse if necessary.</p>

      <p>The <strong>factory method</strong> takes a GeoJSON feature object, and returns an
      HTML element that will be added as a marker for that feature. The element can have
      childNodes, and if you want the markers to be clickable, or any other interaction to be
      added, attach event listeners to the elements in your factory method.</p>

      <p>mmg is open source licensed under BSD</p>

    </div>
    <style>
      .mmg-default {
        background:magenta;
        width:10px;
        height:10px;
      }
      .my-custom {
        position:absolute;
        background:#fffa96;
      }
    </style>
    <script type='text/javascript'>
      wax.tilejson('http://a.tiles.mapbox.com/v3/tmcw.boldness.jsonp',
        function(tj) {
          var m = new MM.Map('map', new wax.mm.connector(tj))
            .setCenterZoom(new MM.Location(0, 0), 2);

          m.addLayer(mmg().url('example/random_geojson_points.geojson'));

          var ft = [{ 'type': 'Feature',
            'geometry': {
              'type': 'Point',
              'coordinates': [-40.0, 30.0]
            },
            'properties': { 'name': 'Tom' }
          }];

          var tomLayer = mmg().factory(function(x) {
            var d = document.createElement('div');
            d.setAttribute('class', 'my-custom');
            d.innerHTML = x.properties.name;
            d.onclick = function() {
              alert('hi, ' + this.innerHTML);
            };
            return d;
          }).features(ft);

          m.addLayer(tomLayer);
        });
    </script>
  </body>
</html>
